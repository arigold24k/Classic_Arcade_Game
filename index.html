<!doctype>
<html>
<header>
    <title>Street Fighter RPG</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/css/style.css">
    <script src="https://code.jquery.com/jquery.js"></script>
</header>
<body>
        <div class="row street-machine">
            <div class="col-md-12">
                <h1 class="street">Street</h1>
                <h3 class="machine">Fighter</h3>
            </div>
        </div>
    <div class="container">
        <!--First Row with row title-->
            <div class="row">
                <div class="col-md-8 selectchar">
                <!-- Images available to select all -->
                    <div class="charimages am" id="img1">
                        <div class="nametag">Ryu</div>
                        <img id="ryu" value="ryu" src="assets/images/ryu.jpeg">
                        <div class="health hp" id="char1">120</div>
                    </div>
                    <div class="charimages am" id="img2">
                        <div class="nametag2">Akuma</div>
                        <img id="akuma" value="akuma" src="assets/images/akuma.jpeg">
                        <div class="health2 hp" id="char2">100</div>
                    </div>
                    <div class="charimages am" id="img3">
                        <div class="nametag3">Chun-Li</div>
                        <img id="chunli" value="chunli" src="assets/images/chuli.jpeg">
                        <div class="health3 hp" id="char3">150</div>
                    </div>
                    <div class="charimages am" id="img4">
                        <div class="nametag4">Bison</div>
                        <img id="bison" value="bison" src="assets/images/bison.jpeg">
                        <div class="health4 hp" id="char4">180</div>
                    </div>
                </div>
                <!--updating info for the game -->
                <div class="col-md-4 mescol">
                    <div id="line1" class="smalltext"></div>
                    <div id="line2" class="smalltext"></div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 bigtext mx">
                    <p>Your Character</p>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 usrchar">
                <!-- Add the character the user chose -->

                </div>
            </div>

            <div class="row">
                <div class="col-md-4 bigtext mx">
                    <p>Enemies Available to attack</p>
                </div>
            </div>

            <div class="row">
                    <div class="col-md-8 availtofight">
                <!-- input images of characters available to fight -->


                </div>
            </div>

            <div class="row">
                <div class="col-md-4 bigtext">
                    <p>Fight Section</p>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    <button class="btn btn-primary action">Attack</button>
                </div>
            </div>

            <div class="row">
               <div class="col-md-4 bigtext1 mx">
                    <p>Defender</p>
               </div>
            </div>

            <div class="row">
                <div class="col-md-6 contender">
                <!-- input image of contender -->

                </div>

            </div>

            <div class="row">
                <div class="row">
                    <div class="col-md 4">
                        <p><span></span></p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md 4">
                        <p><span></span></p>
                    </div>
                </div>
            </div>

    </div>
<script>
$(document).ready(function (e) {
    var characterlock = false;
    var userchar = "";
    var charhealth;
    var enemhealth;
    var ecurhealth;
    var ccurhealth;
    var userattack = 0;
    var enemattack = 0;
    var useriniattack;
    var eneminiattack;
    var enemsel;

    function clearmes () {
        $(".mescol").removeClass("msgbox");
        $("#line1").html("");
        $("#line2").html("");
    }
//    Event Delegation
//    $(document).on('click', '.fighters', function () {
//
//    });

    $(document).on("click", ".am", function () {
        clearmes();
        if(characterlock === true && $(this).attr("id") !== userchar && $(".contender").children("div").attr("id") === undefined ) {
            console.log("Hello World!!");
            console.log($(".contender").children("div").attr("id"));
            console.log($(this).attr("id"));

            var imgid = $(this).children(".hp").attr("id");

            enemattack = 0;
            eneminiattack = Math.floor(Math.random()*10 + 10);
            ecurhealth = document.getElementById(imgid);
            enemhealth = Number(ecurhealth.textContent);

            console.log(enemhealth);
            console.log(enemattack);

            enemsel = $(this);
            enemsel.remove();
            $(".contender").append(enemsel);

        }

        else if (characterlock === false) {
            userchar = $(this).attr("id");

            var imgid = $(this).children(".hp").attr("id");
            useriniattack = Math.floor(Math.random()*10 + 10);
            ccurhealth = document.getElementById(imgid);
            charhealth = Number(ccurhealth.textContent);
            console.log(charhealth);
            console.log(userattack);



            var selpl = $(this);
            $(this).removeClass("am");
            selpl.remove();
            $(".usrchar").append(selpl);

            console.log(userchar);

            $(".am").each(function () {
                var enimg = $(this);
                enimg.remove();
                $(".availtofight").append(enimg);
                characterlock = true;
                return userchar;
            })
        }

    });

    $(".action").on("click", function () {
        if($(".contender").children("div").attr("id") === undefined && $(".usrchar").children("div").attr("id") === undefined) {
            $(".mescol").addClass("msgbox");
            $("#line1").html("Character not Selected");
            $("#line2").html("Opponent not Selected");
        }

        else if($(".contender").children("div").attr("id") === undefined) {
            $(".mescol").addClass("msgbox");
            $("#line1").html("Opponent not Selected");
        }

        else {
            userattack = useriniattack + userattack;
            enemattack = eneminiattack + enemattack;

            if(charhealth - enemattack <= 0 && enemhealth - userattack > 0) {
                enemhealth = enemhealth;
                charhealth = charhealth - enemattack;
            }
            else if(charhealth - enemattack > 0 && enemhealth - userattack <= 0){
                enemhealth = enemhealth - userattack;
                charhealth = charhealth;
            }

            else{
                charhealth = charhealth - enemattack;
                enemhealth = enemhealth - userattack;
            }


            console.log(useriniattack);
            console.log(eneminiattack);
            console.log(userattack);
            console.log(enemattack);

            console.log(charhealth);
            console.log(enemhealth);

            if (charhealth > 0 && enemhealth > 0) {
                console.log("attack is working");
                ccurhealth.textContent = charhealth;
                ecurhealth.textContent = enemhealth;
            }
            else if((charhealth <= 0) && (enemhealth > 0)) {
                charhealth = 0;
                ccurhealth.textContent = charhealth;
                ecurhealth.textContent = enemhealth;
                $(".mescol").addClass("msgbox");
                $("#line1").html("You have been Defeated!.");
                $("#line2").html("<button class=\"btn btn-primary reset\">Reset</button>");

            }

            else if((charhealth > 0) && (enemhealth <= 0)) {
                enemhealth = 0;
                ccurhealth.textContent = charhealth;
                ecurhealth.textContent = enemhealth;
                if($(".availtofight").children("div").attr("id") === undefined) {
                    $(".mescol").addClass("msgbox");
                    $("#line1").html("You are Victorious!.");
                    $("#line2").html("<button class=\"btn btn-primary reset\">Reset</button>");
                }

                else {
                    enemsel.remove();
                    enemattack = 0;
                    $(".mescol").addClass("msgbox");
                    $("#line1").html("You have defeated your enemy!");
                    $("#line2").html("Select your next opponent!");
                }
            }

            else if(charhealth <= 0 && enemhealth <= 0) {
                if(charhealth > enemhealth) {
                    charhealth = 1;
                    enemhealth = 0;
                    ccurhealth.textContent = charhealth;
                    ecurhealth.textContent = enemhealth;
                    enemsel.remove()
                    $(".mescol").addClass("msgbox");
                    $("#line1").html("You have defeated your Enemy!!");
                    $("#line2").html("Select your next opponent!");
                }

                else {
                    charhealth = 0;
                    enemhealth = 1;
                    ccurhealth.textContent = charhealth;
                    ecurhealth.textContent = enemhealth;
                    $(".mescol").addClass("msgbox");
                    $("#line1").html("You have been Defeated!.");
                    $("#line2").html("<button class=\"btn btn-primary reset\">Reset</button>");


                }
            }
        }
    })

  $(document).on("click", ".reset", function () {
      location.reload();
  })

});
</script>

</body>
</html>